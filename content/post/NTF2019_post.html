---
title: NTF2019 - R for Enviro Data Analysis
output: 
  blogdown::html_page: 
    highlight: tango
    css: css/camp_style.css
    number_sections: false
    self_contained: false
    toc: true
    toc_depth: 1
date: '2018-12-13'
showDate: false
showAuthor: false
summary: "Based on ozone monitoring data what's the best month to travel to Tatooine? Power on your droids, we are going to use R to..."
slug: 'NTF2019'
categories: [training]
tags: [training]
type: ''
image: '../images/ntf2019.png' 
imageWidth: '22%'
imageFloat: 'left'
---

<link href="/rmarkdown-libs/font-awesome/css/all.css" rel="stylesheet" />
<link href="/rmarkdown-libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
  <link rel="stylesheet" href="css\camp_style.css" type="text/css" />

<div id="TOC">
<ul>
<li><a href="#introductions">Introductions</a></li>
<li><a href="#why-r">Why R?</a></li>
<li><a href="#rstudio---the-grand-tour">RStudio - The grand tour</a></li>
<li><a href="#first-steps">First steps</a></li>
<li><a href="#read-the-data">1. | Read the data</a></li>
<li><a href="#plot-the-data">2. | Plot the data</a></li>
<li><a href="#explore-the-data">3. | Explore the data</a></li>
<li><a href="#clean-the-data">4. | Clean the data</a></li>
<li><a href="#porgs-to-the-rescue">Porgs to the rescue!</a></li>
<li><a href="#lunch-break"><i class="fa fa-utensils"></i> ☕ <code>Lunch break</code></a></li>
<li><a href="#dates">Dates</a></li>
<li><a href="#guess-who">Guess Who?</a></li>
<li><a href="#more-plots">5. | More plots!</a></li>
<li><a href="#combine-tables-with-left_join">Combine tables with <code>left_join()</code></a></li>
<li><a href="#group-and-summarize-the-data">6. | Group and Summarize the data</a></li>
<li><a href="#save-results">7. | Save results</a></li>
<li><a href="#share-with-friends">8. | Share with friends</a></li>
<li><a href="#help"><i class="far fa-question-circle" aria-hidden="true"></i> Help!</a></li>
<li><a href="#customize-r-studio">Customize R Studio</a></li>
</ul>
</div>

<h1 style="margin-top: 35px;">
Welcome!
</h1>
<hr>
<div class="figure">
<img src="../images/scaryR.jpg" style="margin-left: 11%; width: 78%;" />

</div>
<p><br<br><br><br></p>
<div class="figure">
<img src="../images/day1_bb8_sq.png" style="float: left; margin-right: 34px; margin-bottom: 14px;" width="220" />

</div>
<div id="power-on-your-droids" class="section level3">
<h3>Power on your droids</h3>
<p>You and BB8 have arrived just in time. Rey needs your help!</p>
<p>Rey has to travel to Tatooine, but years of scrapping ship parts hasn’t been kind to her lungs. Using past pollution levels, let’s find the best month for Rey to visit the dusty surface of Tatooine.</p>
</div>
<div id="open-rstudio" class="section level2">
<h2>Open <em>RStudio</em></h2>
<div style="width: 48%; float: left; margin-right: 5%; margin-top: -14px;">
<div class="figure">
<img src="../images/rstudio_logo.png" style="width: 88%; margin-top: -35px; margin-bottom: -6px;" />

</div>
<ul>
<li><strong>Where’s my R!</strong> <em>Need to install R or RStudio? Jump over to <a href="../page/install.html">Get R!</a></em></li>
<li><strong>Install troubles? No permissions?</strong> <em>No worries. You can use R online at <a href="https://rstudio.cloud/">RStudio Cloud</a>.</em></li>
</ul>
<p><br><br></p>
</div>
<div class="figure">
<img src="../images/rstudio_open.png" style="width: 36%;" />

</div>
<div style="clear: both;">

</div>
</div>
<div id="introductions" class="section level1">
<h1>Introductions</h1>
<hr>
<div id="good-morning" class="section level3">
<h3>Good morning!</h3>
<p>We are Melinda, Vallen, Jaime, Kristie &amp; Dorian.</p>
<p>We like <strong>R</strong>.</p>
<p>We aren’t computer scientists and that’s okay!</p>
<p>We make lots of mistakes. Mistakes are funny. You can laugh with us.</p>
</div>
<div id="all-together-now" class="section level2 unnumbered">
<h2>All together now</h2>
<p>Let’s launch ourselves into the unknown and use R to store some data. We’re going to use R to introduce a friend and the data they love. Find a partner and learn 3 things about them.</p>
<p><br></p>
<div class="figure">
<img src="../images/starwars_group.jpg" align="right" style="width: 50%; margin-left: 26px; margin-top: 38px;" />

</div>
<p><strong>Things to Share</strong></p>
<div class="note" style="margin-top: 0; line-height: 22px;">
<ul>
<li>Your name<br />
</li>
<li>How far you traveled to here</li>
<li>Types of air data you have</li>
<li>Something you hope to use R for</li>
<li>A favorite snack</li>
<li>How many pets you have</li>
</ul>
</div>
<p><br><br></p>
<ul>
<li>In R Studio click on <strong>File &gt; New File &gt; R Script</strong>. You will see a code editor window open.</li>
</ul>
<div class="figure">
<img src="../images/new_script_file.png" style="width: 70%; margin-bottom: 18px;" />

</div>
<ul>
<li>You will be writing and saving code in this window. This is your code editor.</li>
</ul>
</div>
<div id="create-and-store-values" class="section level2">
<h2>Create and store values</h2>
<p>You can assign values to new objects using the “left arrow”, which is written as <code>&lt;-</code>.</p>
<blockquote>
<p><strong>Left arrow</strong></p>
<p><code>x  &lt;-  5</code></p>
</blockquote>
<p>This is typed using a less-than sign followed by a hyphen. It’s more officially known as the <em>assignment operator</em>. Try adding the code below to your R script and assign a value to an object called <code>partner</code>.</p>
<p><br></p>
<div id="create-values" class="section level3">
<h3>Create values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_partner &lt;-<span class="st"> &quot;Partner&#39;s Name&quot;</span> <span class="co"># Text and characters are put in quotes</span>

miles_traveled &lt;-<span class="st"> </span><span class="dv">1160</span> <span class="co"># A number has no quotes</span>

<span class="co"># A list of data I use</span>
data_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PAHs&quot;</span>, <span class="st">&quot;Ozone&quot;</span>, <span class="st">&quot;Fine particles&quot;</span>) 

best_snack_ever_<span class="dv">99</span> &lt;-<span class="st"> &quot;Air Heads&quot;</span> </code></pre></div>
</div>
<div id="view-values" class="section level3">
<h3>View values</h3>
<p>Now you can type <em><code>partner</code></em> and run that line to see the value stored in that variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_partner</code></pre></div>
<pre><code>## [1] &quot;Partner&#39;s Name&quot;</code></pre>
<p><br></p>
</div>
<div id="copy-values" class="section level3">
<h3>Copy values</h3>
<pre><code>nickname &lt;- my_partner

nickname</code></pre>
<p><br></p>
</div>
</div>
<div id="drop-and-remove-data" class="section level2 unnumbered">
<h2>Drop and remove data</h2>
<p>You can drop objects with the remove function <code>rm()</code>. Try it out on some of your objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Delete objects to clean-up your environment</span>
<span class="kw">rm</span>(nickname)</code></pre></div>
<div class="tip">
<h3 id="exercise" class="unnumbered"><i class="fa fa-bicycle" aria-hidden="true" style="color: darkgreen;"></i> EXERCISE!</h3>
<p>How can we get the ‘nickname’ object back?</p>
<p><strong>HINT:</strong> The UP arrow in the Console is your friend.</p>
</div>
<p><br></p>
<blockquote>
<p>To run everything in one go, highlight all of the code in the Code Editor and push <code>CTRL</code>+<code>ENTER</code>.</p>
</blockquote>
</div>
<div id="its-all-about-you" class="section level2">
<h2>It’s ALL about you</h2>
<p>Now we can create a data table, which in R is also called a <code>data.frame</code> or a <code>tibble</code>. When creating one, the column names go on the <em>left</em>, and the values you want to put in the column go on the <em>right</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Put the items into a table</span>
all_about_you &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name           =</span> my_partner, 
                            <span class="dt">miles_traveled =</span> miles_traveled, 
                            <span class="dt">data_types     =</span> data_types,  
                            <span class="dt">best_snack     =</span> best_snack_ever_<span class="dv">99</span>)</code></pre></div>
<p>Let’s bounce around the room and introduce ourselves with help from our new data frames.</p>
<p><details style="margin-top: 34px;"> <summary class="btn_code"> <strong>GET R PACKAGES</strong> </summary></p>
<div class="quiz" style="margin-top: -8px; border-radius: 0;">
<p>
<p>To use a new <em>package</em> in R you first need to install it – much like a free App on your phone. To save time on installation, you can copy the text below and paste it into the RStudio <em>Console</em>. It’s the quadrant on the lower left when you open RStudio. The one with the <code>&gt;</code> symbols.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_packages &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;readr&quot;</span>, <span class="st">&quot;readxl&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;stringr&quot;</span>,
                  <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;lubridate&quot;</span>, <span class="st">&quot;janitor&quot;</span>, <span class="st">&quot;curl&quot;</span>)

<span class="kw">install.packages</span>(new_packages)</code></pre></div>
<div class="figure">
<img src="../../images/install_screen.png" />

</div>
<p style="margin-top: 5px;">
<p>Then press <code>ENTER</code> to begin the installation. If all goes well, you should start to see some messages appear similar to these:</p>
<img src="../../images/install_msg.png" />
</p>
<p><strong>Congrats rebel droid!</strong> <i class="fa fa-android" style="font-size: 44px;"></i></p>
</p>
</div>
<p></details></p>
<p><br></p>
</div>
</div>
<div id="why-r" class="section level1">
<h1>Why R?</h1>
<hr>
<div class="figure">
<img src="../images/rladies_map.gif" style="width: 95%;" />

</div>
<div id="r-community" class="section level2">
<h2>R Community</h2>
<ul>
<li>See the <a href="../page/community.html">R Community</a> page.</li>
<li>ITEP page for sharing &amp; questions - <a href="https://github.com/itep-data/R-questions">R questions</a></li>
<li>Finding R Help - <a href="https://itep-r.netlify.com/page/help.html">Get help!</a>
<ul>
<li>R cheatsheets</li>
</ul></li>
</ul>
</div>
<div id="when-do-we-use-r" class="section level2">
<h2>When do we use R?</h2>
<ul>
<li>To connect to databases</li>
<li>To read data from websites</li>
<li>To document and share methods</li>
<li>When data will have frequent updates</li>
<li>When we want to improve a process over time</li>
</ul>
</div>
<div id="r-is-for-reading" class="section level2">
<h2>R is for reading</h2>
<div class="figure">
<img src="../images/R_recipe.png" style="width: 55%; float: left; margin-right: 28px; margin-left: -16px; margin-top: 8px;" />

</div>
<p>Lucky for us, programming doesn’t have to be a bunch of math equations. R allows you to write your data analysis in a step-by-step fashion, much like creating a recipe for cookies. And just like a recipe, we can start at the top and read our way down to the bottom.</p>
<div style="clear: both;">

</div>
<p><br></p>
</div>
<div id="it-begins" class="section level2">
<h2>It begins!</h2>
</div>
<div id="todays-challenge" class="section level2">
<h2>Today’s challenge</h2>
<hr>
<div class="figure">
<img src="https://i.pinimg.com/736x/7b/c0/02/7bc00221cf62f736fa1592efd7ba6213.jpg" style="float: left; margin-right: 24px; margin-bottom: 14px;" width="254" />

</div>
<p><br></p>
<blockquote>
<p>Rey needs to visit Tatooine to help the Rebel Alliance, and we have ozone data to help her decide what month she should visit. Preferably the month with the lowest ozone concentrations. Let’s make a nice reference chart of monthly ozone concentrations to help her plan.</p>
</blockquote>
<p><br></p>
<p>We’ll follow the general roadmap below.</p>
<div style="clear: both;">

</div>
<div id="todays-workflow" class="section level3">
<h3>Today’s workflow</h3>
<div class="note">
<ol style="list-style-type: decimal">
<li><strong>READ</strong> the data</li>
<li><strong>PLOT</strong> the data</li>
<li><strong>CLEAN</strong> the data</li>
</ol>
<ul>
<li>( <strong>PLOT</strong> some more )</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>SUMMARIZE</strong> the data</li>
</ol>
<ul>
<li>( <strong>PLOT</strong> even more )</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>SAVE</strong> the results</li>
<li><strong>SHARE</strong> with friends</li>
</ol>
</div>
<p><br></p>
</div>
<div id="start-an-r-project" class="section level3 unnumbered">
<h3>Start an R project</h3>
<p>We’ll make a new project for our investigation of ozone on Tatooine.</p>
<div class="well" style="margin-left: 5%;">
<p><strong>Step 1:</strong> Start a new project</p>
<ul>
<li>In <em>Rstudio</em> select <em>File</em> from the top menu bar
<ul>
<li>Choose <em>New Project…</em></li>
<li>Choose <em>New Directory</em></li>
<li>Choose <em>New Project</em></li>
</ul></li>
<li>Enter a project name such as <code>&quot;NTF_2019&quot;</code></li>
<li>Select <em>Browse…</em> and choose a folder where you normally perform your work.
<ul>
<li>Click <em>Create Project</em></li>
</ul></li>
</ul>
<p><strong>Step 2:</strong> Open a new script</p>
<ul>
<li><strong>File &gt; New File &gt; R Script</strong>
<ul>
<li>Click the <em>floppy disk</em> save icon</li>
<li>Give it a name: <code>ozone.R</code> will work well</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="rstudio---the-grand-tour" class="section level1">
<h1>RStudio - The grand tour</h1>
<div class="figure">
<img src="../images/rstudio.png" style="width: 85%;" />

</div>
<p><br></p>
<div class="red-note">
<p><strong>1. Code Editor</strong></p>
<p>This is where you write your scripts and document your work. The tabs at the top of the code editor allow you to view scripts and data sets you have open. This is where you’ll spend most of your time.</p>
</div>
<div class="red-note">
<p><strong>2. Console</strong></p>
<p>This is where code is executed by the computer. It shows code that you have run and any errors, warnings, or other messages resulting from that code. You can input code directly into the console and run it, but it won’t be saved for later. That’s why we like to run all of our code directly from a script in the code editor.</p>
</div>
<div class="red-note">
<p><strong>3. Workspace</strong></p>
<p>This pane shows all of the objects and functions that you have created, as well as a history of the code you have run during your current session. The environment tab shows all of your objects and functions. The history tab shows the code you have run. Note the <em>broom</em> icon below the Connections tab. This cleans shop and allows you to clear all of the objects in your workspace.</p>
</div>
<div class="red-note">
<p><strong>4. Plots and files</strong></p>
<p>These tabs allow you to view and open files in your current directory, view plots and other visual objects like maps, view your installed packages and their functions, and access the help window. If at anytime you’re unsure what a function does, enter it’s name after a question mark. For example, try entering <code>?mean</code> into the console and push <strong>ENTER</strong>.</p>
</div>
</div>
<div id="first-steps" class="section level1">
<h1>First steps</h1>
</div>
<div id="read-the-data" class="section level1">
<h1>1. | Read the data</h1>
<hr>
<p><br></p>
<div class="figure">
<img src="../images/readr-hexbin-sticker-from-rstudio.png" style="width: 18%; float: left; margin-right: 6px;" />

</div>
<div style="width: 81%; float: right;">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;readr&quot;)</span>
<span class="kw">library</span>(readr)

air_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/ozone_samples.csv&quot;</span>)</code></pre></div>
</div>
<div style="clear: both;">

</div>
<table>
<thead>
<tr class="header">
<th align="left">DateTime</th>
<th align="left">SITE</th>
<th align="right">OZONE</th>
<th align="right">LATITUDE</th>
<th align="right">LONGITUDE</th>
<th align="right">TEMP_F</th>
<th align="left">UNITS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2015-04-06 20:00:00</td>
<td align="left">27-017-7417</td>
<td align="right">0.043</td>
<td align="right">46.71369</td>
<td align="right">-92.51172</td>
<td align="right">36.19</td>
<td align="left">PPM</td>
</tr>
<tr class="even">
<td align="left">2015-08-21 08:00:00</td>
<td align="left">27-017-7417</td>
<td align="right">0.010</td>
<td align="right">46.71369</td>
<td align="right">-92.51172</td>
<td align="right">51.41</td>
<td align="left">PPM</td>
</tr>
<tr class="odd">
<td align="left">2015-10-23 05:00:00</td>
<td align="left">27-017-7417</td>
<td align="right">0.019</td>
<td align="right">46.71369</td>
<td align="right">-92.51172</td>
<td align="right">43.06</td>
<td align="left">PPM</td>
</tr>
<tr class="even">
<td align="left">2014-10-21 06:00:00</td>
<td align="left">27-137-7001</td>
<td align="right">0.000</td>
<td align="right">47.52336</td>
<td align="right">-92.53630</td>
<td align="right">42.50</td>
<td align="left">PPM</td>
</tr>
<tr class="odd">
<td align="left">2015-12-17 17:00:00</td>
<td align="left">27-017-7417</td>
<td align="right">0.020</td>
<td align="right">46.71369</td>
<td align="right">-92.51172</td>
<td align="right">23.53</td>
<td align="left">PPM</td>
</tr>
</tbody>
</table>
<div id="clean-header-names" class="section level2">
<h2>Clean header names</h2>
<hr>
<div class="figure">
<img src="../images/janitor_hex.png" style="width: 17%; float: right; margin-right: 6px; margin-left: 6px;" />

</div>
<div class="figure">
<img src="../images/dplyr_hex.png" style="width: 17%; float: right; margin-left: 30px;" />

</div>
<p><br></p>
<p>There are two great packages that can help us with cleaning header names. Let’s install them!</p>
<p><br></p>
<div style="clear: both;">

</div>
<div id="install-new-packages" class="section level3">
<h3>Install new packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;janitor&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</code></pre></div>
</div>
<div id="load-packages-from-your-personal-library" class="section level3">
<h3>Load packages from your personal <code>library()</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(janitor)
<span class="kw">library</span>(dplyr)

<span class="co"># General cleaning for all columns</span>
air_data &lt;-<span class="st"> </span><span class="kw">clean_names</span>(air_data)

<span class="co"># Change and set specific names</span>
air_data &lt;-<span class="st"> </span><span class="kw">rename</span>(air_data,
                   <span class="dt">lat =</span> latitude,
                   <span class="dt">lon =</span> longitude)</code></pre></div>
<p><strong>View the new names</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(air_data)</code></pre></div>
<pre><code>## [1] &quot;date_time&quot; &quot;site&quot;      &quot;ozone&quot;     &quot;lat&quot;       &quot;lon&quot;       &quot;temp_f&quot;   
## [7] &quot;units&quot;</code></pre>
</div>
</div>
</div>
<div id="plot-the-data" class="section level1">
<h1>2. | Plot the data</h1>
<div id="plot-the-data-plot-the-data-plot-the-data" class="section level4 unnumbered">
<h4><em>Plot the data, Plot the data, Plot the data</em></h4>
<div class="figure">
<img src="../images/ggplot2_hex.png" style="width: 22%; float: left; margin-right: 4%;" />

</div>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;ggplot2&quot;)</span>
<span class="kw">library</span>(ggplot2)

<span class="kw">ggplot</span>(air_data, <span class="kw">aes</span>(<span class="dt">x =</span> temp_f, <span class="dt">y =</span> ozone, <span class="dt">color =</span> site)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) </code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/view-1.png" width="1152" /></p>
<div style="clear: both;">

</div>
</div>
<div id="break-it-down-now" class="section level2">
<h2>Break it down now</h2>
</div>
<div id="the-ggplot-sandwich" class="section level2 unnumbered">
<h2>The <code>ggplot()</code> sandwich</h2>
<div class="figure">
<img src="../images/auto_plot.gif" style="margin-top: -22px; margin-left: -40px; max-width: 110%;" />

</div>
<h5 style="font-size: 28px; font-weight: bold; margin-top: -42px;">
A <code>ggplot</code> has 3 ingredients.
</h5>
</div>
<div id="the-base-plot" class="section level2 unnumbered">
<h2>1. The base plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_data)</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="the-the-x-y-aesthetics" class="section level2 unnumbered">
<h2>2. The the X, Y <em>aesthetics</em></h2>
<p>The <em>aesthetics</em> assign the components from the data that you want to use in the chart. These also determine the dimensions of the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_data, <span class="kw">aes</span>(<span class="dt">x =</span> temp_f, <span class="dt">y =</span> ozone)) </code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="the-layers-or-geometries" class="section level2 unnumbered">
<h2>3. The layers or <em>geometries</em></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_data, <span class="kw">aes</span>(<span class="dt">x =</span> temp_f, <span class="dt">y =</span> ozone)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><br></p>
<div class="tip">
<h4 id="exercise-1" class="unnumbered"><i class="fa fa-exercise" aria-hidden="true" style="color: green"></i> EXERCISE</h4>
<p>Try making a scatterplot of any two columns. Here’s a template to get you started.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_data, <span class="kw">aes</span>(<span class="dt">x =</span> column1, <span class="dt">y =</span> column2 )) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><em>Hint: Numeric variables will be more exciting.</em></p>
</div>
<p><br></p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>We load the package <code>library (ggplot2)</code>, but the function to make a plot is <code>ggplot(scrap)</code>.</p>
</blockquote>
</div>
</div>
<div id="explore-the-data" class="section level1">
<h1>3. | Explore the data</h1>
<p>Some functions to get to know your data.</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Information</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>names(air_data)</code></td>
<td align="left">column names</td>
</tr>
<tr class="even">
<td align="left"><code>nrow(...)</code></td>
<td align="left">number of rows</td>
</tr>
<tr class="odd">
<td align="left"><code>ncol(...)</code></td>
<td align="left">number of columns</td>
</tr>
<tr class="even">
<td align="left"><code>summary(...)</code></td>
<td align="left">a summary of all column values (ex. <em>max</em>, <em>mean</em>, <em>median</em>)</td>
</tr>
<tr class="odd">
<td align="left"><code>glimpse(...)</code></td>
<td align="left">column names + a glimpse of first values (use <em>dplyr</em> package)</td>
</tr>
</tbody>
</table>
<div id="glimpse-and-summary" class="section level2">
<h2><code>glimpse()</code> and <code>summary()</code></h2>
<p>Use the <code>glimpse()</code> function to find out what type and how much data you have.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

<span class="co"># Glimpse the columns of your data and their first few contents</span>
<span class="kw">glimpse</span>(air_data)</code></pre></div>
<pre><code>## Observations: 6,665
## Variables: 7
## $ date_time &lt;dttm&gt; 2015-07-06 09:00:00, 2015-07-13 04:00:00, 2015-07-1...
## $ site      &lt;chr&gt; &quot;27-017-7417&quot;, &quot;27-017-7417&quot;, &quot;27-017-7417&quot;, &quot;27-017...
## $ ozone     &lt;dbl&gt; 0, -1, -2, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, -1, -1, 0...
## $ lat       &lt;dbl&gt; 46.71369, 46.71369, 46.71369, 46.71369, 46.71369, 46...
## $ lon       &lt;dbl&gt; -92.51172, -92.51172, -92.51172, -92.51172, -92.5117...
## $ temp_f    &lt;dbl&gt; 64.36, 64.49, 63.23, 61.49, 61.30, 71.22, 76.63, 64....
## $ units     &lt;chr&gt; &quot;PPM&quot;, &quot;PPM&quot;, &quot;PPM&quot;, &quot;PPM&quot;, &quot;PPM&quot;, &quot;PPM&quot;, &quot;PPM&quot;, &quot;PP...</code></pre>
<p><br></p>
<p>Use the <code>summary()</code> function to get a quick report of your numeric data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show numeric summary of the min, mean, and max of all columns</span>
<span class="kw">summary</span>(air_data)</code></pre></div>
<pre><code>##    date_time                       site               ozone         
##  Min.   :2014-04-03 03:00:00   Length:6665        Min.   :-4.00000  
##  1st Qu.:2015-06-07 10:00:00   Class :character   1st Qu.: 0.01700  
##  Median :2015-08-16 20:00:00   Mode  :character   Median : 0.02500  
##  Mean   :2015-08-13 15:04:35                      Mean   : 0.01666  
##  3rd Qu.:2015-10-24 12:00:00                      3rd Qu.: 0.03500  
##  Max.   :2016-01-01 05:00:00                      Max.   : 0.07500  
##       lat             lon             temp_f         units          
##  Min.   :46.71   Min.   :-92.54   Min.   : 1.83   Length:6665       
##  1st Qu.:46.71   1st Qu.:-92.51   1st Qu.:37.85   Class :character  
##  Median :46.71   Median :-92.51   Median :52.32   Mode  :character  
##  Mean   :46.73   Mean   :-92.51   Mean   :50.85                     
##  3rd Qu.:46.71   3rd Qu.:-92.51   3rd Qu.:63.59                     
##  Max.   :47.52   Max.   :-92.51   Max.   :90.01</code></pre>
<p><br></p>
<p>Try running some of these in your script.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(air_data)

<span class="kw">ncol</span>()

<span class="kw">names</span>()</code></pre></div>
</div>
</div>
<div id="clean-the-data" class="section level1">
<h1>4. | Clean the data</h1>
<hr>
<div id="its-time-for-dplyr" class="section level2">
<h2>It’s time for <code>dplyr</code></h2>
<hr>
<div class="figure">
<img src="../images/dplyr_hex.png" align="left" style="margin-right: 32px; margin-top: 8px; margin-bottom: 20px;" width="128" />

</div>
<p><br></p>
<p>This is our go-to package for most analysis tasks. With the six functions below you can accomplish just about anything you want.</p>
<p><br></p>
<div style="clear: both;">

</div>
<blockquote>
<h3 id="your-new-analysis-toolbox" class="unnumbered"><i class="fa fa-toolbox" aria-hidden="true" style="color: grey;"></i> Your new analysis toolbox</h3>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Job</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>select()</code></td>
<td align="left">Select individual columns to drop or keep</td>
</tr>
<tr class="even">
<td align="left"><code>arrange()</code></td>
<td align="left">Sort a table top-to-bottom based on the values of a column</td>
</tr>
<tr class="odd">
<td align="left"><code>filter()</code></td>
<td align="left">Keep only a subset of rows depending on the values of a column</td>
</tr>
<tr class="even">
<td align="left"><code>mutate()</code></td>
<td align="left">Add new columns or update existing columns</td>
</tr>
<tr class="odd">
<td align="left"><code>summarize()</code></td>
<td align="left">Calculate a single summary for an entire table</td>
</tr>
<tr class="even">
<td align="left"><code>group_by()</code></td>
<td align="left">Sort data into groups based on the values of a column</td>
</tr>
</tbody>
</table>
</blockquote>
</div>
</div>
<div id="porgs-to-the-rescue" class="section level1">
<h1>Porgs to the rescue!</h1>
<p>We recruited a poggle of porgs to help demo the <code>dplyr</code> functions. There are two types of porgs: yellow-eyed and gray-eyed.</p>
<style> img {margin: 0;} </style>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="porgs-tab" data-toggle="tab" href="#porgs" role="tab" aria-controls="porgs" aria-selected="true"> porgs </a>
</li>
<li class="nav-item">
<a class="nav-link" id="select-tab" data-toggle="tab" href="#select" role="tab" aria-controls="select" aria-selected="false"> <code>select</code> </a>
</li>
<li class="nav-item">
<a class="nav-link" id="arrange-tab" data-toggle="tab" href="#arrange" role="tab" aria-controls="arrange" aria-selected="false"> <code>arrange</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="filter-tab" data-toggle="tab" href="#filter" role="tab" aria-controls="filter" aria-selected="false"> <code>filter</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="mutate3-tab" data-toggle="tab" href="#mutate3" role="tab" aria-controls="mutate3" aria-selected="false"> <code>mutate</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="summarize-tab" data-toggle="tab" href="#summarize" role="tab" aria-controls="summarize" aria-selected="false"> <code>summarize</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="group_by-tab" data-toggle="tab" href="#group_by" role="tab" aria-controls="group_by" aria-selected="false"> <code>group_by</code></a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="porgs" class="tab-pane fade active in" role="tabpanel" aria-labelledby="porgs-tab">
<img src="../images/porgs/porgs_tbl.png" style="width: 85%;" /> <br><br>
</div>
<div id="select" class="tab-pane fade" role="tabpanel" aria-labelledby="select-tab">
<img src="../images/porgs/select_card.png" style="width: 90%;" /> <br><br> <img src="../images/porgs/select_drop.png" style="width: 65%;" /> <img src="../images/porgs/select_drop_tbl.png" style="width: 80%; margin-left: 5%; margin-top: 12px;" /> <br><br>
</div>
<div id="arrange" class="tab-pane fade" role="tabpanel" aria-labelledby="arrange-tab">
<img src="../images/porgs/arrange.png" style="width: 65%;" /> <img src="../images/porgs/arrange_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/arrange_desc.png" style="width: 57%;" /> <img src="../images/porgs/arrange_tbl_desc.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="filter" class="tab-pane fade" role="tabpanel" aria-labelledby="filter-tab">
<img src="../images/porgs/filter.png" style="width: 65%;" /> <img src="../images/porgs/filter_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/filter2.png" style="width: 75%;" /> <img src="../images/porgs/filter2_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="mutate3" class="tab-pane fade" role="tabpanel" aria-labelledby="mutate3-tab">
<img src="../images/porgs/mutate_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="summarize" class="tab-pane fade" role="tabpanel" aria-labelledby="summarize-tab">
<img src="../images/porgs/summarize_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="group_by" class="tab-pane fade" role="tabpanel" aria-labelledby="group_by-tab">
<img src="../images/porgs/groupby_card.png" style="width: 92%;" /> <br><br>
</div>
</div>
<p><br></p>
<blockquote>
<p>Back to the ozone data…</p>
</blockquote>
<div id="filter-out-values-that-are-out-of-range" class="section level2 unnumbered">
<h2>Filter out values that are out-of-range</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Drop values out of range</span>
air_data &lt;-<span class="st"> </span><span class="kw">filter</span>(air_data, ozone <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)

<span class="co"># We can filter with two conditions</span>
air_data &lt;-<span class="st"> </span><span class="kw">filter</span>(air_data, ozone <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, temp_f <span class="op">&lt;</span><span class="st"> </span><span class="dv">199</span>) </code></pre></div>
</div>
<div id="show-distinct-values" class="section level2 unnumbered">
<h2>Show <code>distinct()</code> values</h2>
<p><strong>Show the unique values in the <code>site</code> and <code>units</code> column</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show all unique values in the site column</span>
<span class="kw">distinct</span>(air_data, site)</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   site       
##   &lt;chr&gt;      
## 1 27-017-7417</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show all unique values in the units column</span>
<span class="kw">distinct</span>(air_data, units)</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   units
##   &lt;chr&gt;
## 1 PPM</code></pre>
<p>PPM? That explains the tiny results. Let’s convert to <code>PPB</code>. For that we’ll want our friend the <code>mutate</code> function.</p>
</div>
<div id="convert-units" class="section level2">
<h2>Convert units</h2>
<div id="mutate" class="section level3">
<h3><code>mutate()</code></h3>
<p>For <code>mutate</code>, the name of the column goes on the <em>left</em>, and the calculation of its new value goes on the <em>right</em>.</p>
<p><strong>Update the column <code>ozone</code></strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert all samples to PPB</span>
air_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(air_data, <span class="dt">ozone =</span> ozone <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>) </code></pre></div>
<p><strong>Update the column <code>units</code></strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set units column to PPB</span>
air_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(air_data, <span class="dt">units =</span> <span class="st">&quot;PPB&quot;</span>) </code></pre></div>
<br><br>
<hr>
<div class="figure">
<img src="../images/chewie_box.png" style="width: 56%; float: left; margin-right: 11px;" />

</div>
<p><br></p>
</div>
</div>
</div>
<div id="lunch-break" class="section level1">
<h1><i class="fa fa-utensils"></i> ☕ <code>Lunch break</code></h1>
<div style="clear: both;">

</div>
<br><br>
<hr>
<p><br></p>
</div>
<div id="dates" class="section level1">
<h1>Dates</h1>
<hr>
<div id="the-lubridate-package" class="section level3">
<h3>The <code>lubridate</code> package</h3>
<div class="figure">
<img src="../images/lubridate.png" style="width: 22%; float: left; margin-right: 30px; margin-top: 8px; margin-bottom: 12px;" />

</div>
<p><br></p>
<p>It’s about time! Lubridate makes working with dates easier. We can find how much time has elapsed, add or subtract days, and aggregate to seasonal, monthly, or day of the week averages.</p>
<p><br></p>
<div style="clear: both;">

</div>
</div>
<div id="convert-text-to-a-date" class="section level3 unnumbered">
<h3>Convert text to a <em>DATE</em></h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th align="left">Order of date elements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mdy()</code></td>
<td align="left">Month-Day-Year :: <code>05-18-2019</code> or <code>05/18/2019</code></td>
</tr>
<tr class="even">
<td><code>dmy()</code></td>
<td align="left">Day-Month-Year (Euro dates) :: <code>18-05-2019</code> or <code>18/05/2019</code></td>
</tr>
<tr class="odd">
<td><code>ymd()</code></td>
<td align="left">Year-Month-Day (science dates) :: <code>2019-05-18</code> or <code>2019/05/18</code></td>
</tr>
<tr class="even">
<td><code>ymd_hm()</code></td>
<td align="left">Year-Month-Day Hour:Minutes :: <code>2019-05-18 8:35 AM</code></td>
</tr>
<tr class="odd">
<td><code>ymd_hms()</code></td>
<td align="left">Year-Month-Day Hour:Minutes:Seconds :: <code>2019-05-18 8:35:22 AM</code></td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="get-date-parts" class="section level3 unnumbered">
<h3>Get date parts</h3>
<table>
<thead>
<tr class="header">
<th>Function</th>
<th align="left">Date element</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>year()</code></td>
<td align="left">Year</td>
</tr>
<tr class="even">
<td><code>month()</code></td>
<td align="left">Month as <em>1,2,3</em>; Use <code>label=TRUE</code> for <em>Jan, Feb, Mar</em></td>
</tr>
<tr class="odd">
<td><code>day()</code></td>
<td align="left">Day of the month</td>
</tr>
<tr class="even">
<td><code>wday()</code></td>
<td align="left">Day of the week as <em>1,2,3</em>; Use <code>label=TRUE</code> for <em>Sun, Mon, Tue</em></td>
</tr>
<tr class="odd">
<td><em>- Time -</em></td>
<td align="left"></td>
</tr>
<tr class="even">
<td><code>hour()</code></td>
<td align="left">Hour of the day <em>(24hr)</em></td>
</tr>
<tr class="odd">
<td><code>minute()</code></td>
<td align="left">Minutes</td>
</tr>
<tr class="even">
<td><code>second()</code></td>
<td align="left">Seconds</td>
</tr>
<tr class="odd">
<td><code>tz()</code></td>
<td align="left">Time zone</td>
</tr>
</tbody>
</table>
</div>
<div id="clean-the-dates" class="section level2">
<h2><i class="fa fa-broom" aria-hidden="true"></i> Clean the dates</h2>
<p>Let’s set our date column to the standard date format. Because our dates are written as <code>year-month-day hour:mins</code>, we can Use <code>ymd_hm()</code>.</p>
<p><strong>Format the <code>date_time</code> column as a ‘Date’</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate) 

<span class="co"># Set date column to official date format</span>
air_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(air_data, <span class="dt">date_time =</span> <span class="kw">ymd_hms</span>(date_time))</code></pre></div>
<div class="note">
<h3 id="real-world-examples" class="unnumbered">Real world examples</h3>
<p>Does your date column look like one of these? Here’s the <code>lubridate</code> function to tell R that the column is a date.</p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th align="left">Function to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“05/18/2019”</td>
<td align="left"><code>mdy(date_column)</code></td>
</tr>
<tr class="even">
<td>“May 18, 2019”</td>
<td align="left"><code>mdy(date_column)</code></td>
</tr>
<tr class="odd">
<td>“05/18/2019 8:00 CDT”</td>
<td align="left"><code>mdy_hm(date_column, tz = &quot;US/Central&quot;)</code></td>
</tr>
<tr class="even">
<td>“05/18/2019 11:05:32 PDT”</td>
<td align="left"><code>mdy_hms(date_column, tz = &quot;US/Pacific&quot;)</code></td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>AQS formatted dates</strong></p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th align="left">Function to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“20190518”</td>
<td align="left"><code>ymd(sample_date)</code></td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<blockquote>
<p>Now we can add a variety of date and time columns to our data like the name of the month, the day of the week, or just the hour of the day for each observation.</p>
</blockquote>
<p><strong>Add month and day of the week</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add date parts as new columns</span>
air_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(air_data, 
                   <span class="dt">year     =</span> <span class="kw">year</span>(date_time),
                   <span class="dt">month    =</span> <span class="kw">month</span>(date_time, <span class="dt">label =</span> <span class="ot">TRUE</span>),
                   <span class="dt">day      =</span> <span class="kw">wday</span>(date_time, <span class="dt">label =</span> <span class="ot">TRUE</span>),
                   <span class="dt">hour     =</span> <span class="kw">hour</span>(date_time),
                   <span class="dt">cal_date =</span> <span class="kw">date</span>(date_time)) </code></pre></div>
</div>
<div id="comparing-values" class="section level2 unnumbered">
<h2>Comparing values</h2>
<hr>
<div class="figure">
<img src="../images/porg_heights.png" style="float: right; margin-top: -94px; width: 40%;" />

</div>
<p>Processing data requires many types of filtering. You’ll want to know how to select observations in your table by making various comparisons.</p>
<p><strong>Key comparison operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Symbol</th>
<th align="left">Comparison</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>&gt;</code></td>
<td align="left">greater than</td>
</tr>
<tr class="even">
<td align="left"><code>&gt;=</code></td>
<td align="left">greater than or equal to</td>
</tr>
<tr class="odd">
<td align="left"><code>&lt;</code></td>
<td align="left">less than</td>
</tr>
<tr class="even">
<td align="left"><code>&lt;=</code></td>
<td align="left">less than or equal to</td>
</tr>
<tr class="odd">
<td align="left"><code>==</code></td>
<td align="left">equal to</td>
</tr>
<tr class="even">
<td align="left"><code>!=</code></td>
<td align="left">NOT equal to</td>
</tr>
<tr class="odd">
<td align="left"><code>%in%</code></td>
<td align="left">value is in a list: <code>X %in% c(1,3,7)</code></td>
</tr>
<tr class="even">
<td align="left"><code>is.na(...)</code></td>
<td align="left">is the value missing?</td>
</tr>
<tr class="odd">
<td align="left"><code>str_detect(col_name, &quot;word&quot;)</code></td>
<td align="left">“word” appears in text?</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="guess-who" class="section level1 unnumbered">
<h1>Guess Who?</h1>
<h2 style="margin-top: -24px;">
<em>Star Wars edition</em>
</h2>
<div class="figure">
<img src="../images/sw_guesswho.jpg" align="right" style="margin-top: -65px; margin-left: 24px; margin-right: 8px;" width="280" />

</div>
<blockquote>
<p>Are you the best Jedi detective out there? Let’s play a game to find out.</p>
</blockquote>
<p><br></p>
<p>Guess what else comes with the <code>dplyr</code> package? A <strong>Star Wars data set</strong>.</p>
<div id="open-the-data-set" class="section level4 unnumbered">
<h4>Open the data set:</h4>
<ol style="list-style-type: decimal">
<li>Load the <code>dplyr</code> package from your <code>library()</code></li>
<li>Pull the Star Wars dataset into your environment.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

people &lt;-<span class="st"> </span>starwars</code></pre></div>
</div>
<div id="rules" class="section level3 unnumbered">
<h3><span style="text-decoration: underline;"> Rules </span></h3>
<ol style="list-style-type: decimal">
<li><strong>You have a <em>top secret</em> identity.</strong></li>
<li>Scroll through the Star Wars dataset and find a character you find interesting.
<ul>
<li><em>Or run <code>sample_n(starwars_data, 1)</code> to choose one at random.</em></li>
</ul></li>
<li><strong>Keep it hidden!</strong> Don’t show your neighbor the character you chose.</li>
<li>Take turns asking each other questions about your partner’s Star Wars character.</li>
<li>Use the answers to build a <code>filter()</code> function and narrow down the potential characters your neighbor may have picked.</li>
</ol>
<p>For example: Here’s a <code>filter()</code> statement that filters the data to the character <em>Plo Koon</em>.</p>
<div style="width: 90%; margin-left: 8%">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mr_koon &lt;-<span class="st"> </span><span class="kw">filter</span>(people,
                  mass       <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>,
                  eye_color  <span class="op">!=</span><span class="st"> &quot;blue&quot;</span>,
                  gender     <span class="op">==</span><span class="st"> &quot;male&quot;</span>,
                  homeworld  <span class="op">==</span><span class="st"> &quot;Dorin&quot;</span>,
                  birth_year <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>)</code></pre></div>
</div>
<p>Elusive answers are allowed. For example, if someone asks: <em>What is your character’s mass?</em></p>
<ul>
<li>You can respond:
<ul>
<li><em>My character’s mass is equal to one less than their age.</em></li>
</ul></li>
<li>Or if you’re feeling generous you can respond:
<ul>
<li><em>My character’s mass is definitely more than 100, but less than 140.</em></li>
</ul></li>
</ul>
</div>
<div id="my-character-has-no-hair-missing-values" class="section level3 unnumbered">
<h3>My character has <strong>NO</strong> hair! <em>(Missing values)</em></h3>
<p>Sometimes a character will be missing a specific attribute. We learned earlier how R stores missing values as <code>NA</code>. If your character has a missing value for hair color, one of your filter statements would be <code>is.na(hair_color)</code>.</p>
<p><br></p>
<p><span style="margin-top: 18px; color: green;"> <strong>WINNER!</strong> </span></p>
<p>The winner is the first to guess their neighbor’s character.</p>
<p><details> <summary class = "btn_code_green"> <strong>WINNERS Click here!</strong> </summary></p>
<div class="data" style="margin-top: -12px;">
<p>
<div class="figure">
<img src="../images/cat_win.jpg" style="width:96.0%" />

</div>
</p>
</div>
<p></details></p>
<p><br></p>
<div class="note">
<h3 id="want-to-rematch" class="unnumbered">Want to rematch?</h3>
<p>How about make it best of <strong>3</strong> games?</p>
</div>
<p><br></p>
</div>
</div>
<div id="more-plots" class="section level1">
<h1>5. | More plots!</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_data, <span class="kw">aes</span>(<span class="dt">x =</span> cal_date, <span class="dt">y =</span> ozone, <span class="dt">color =</span> month)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) </code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-10-1.png" width="1248" /></p>
<div id="show-me-the-weather" class="section level2 unnumbered">
<h2>Show me the weather</h2>
<p>Maybe some meteorological data would give us some clues about when high ozone is occurring. Unfortunately, concentration and meteorological data often come to us separately, but we want them joined together for easy plotting.</p>
</div>
</div>
<div id="combine-tables-with-left_join" class="section level1">
<h1>Combine tables with <code>left_join()</code></h1>
<div class="figure">
<img src="../images/left_join_venn.png" style="width: 55%;" />

</div>
<br>
<hr>
<p><code>left_join()</code> works like a zipper and combines two tables based on one or more variables. They can have the same name or not. Since it’s <code>left_join</code>, the entire table on the left side is retained. Anything that matches from the right side is retained and the rest is not retained.</p>
<p><br></p>
<div id="adding-porg-names" class="section level3 unnumbered">
<h3>Adding porg names</h3>
<p>Remember our porg friends? How rude of us not to share their names. <strong>Wups!</strong></p>
<p>Here’s a table of their names.</p>
<div style="margin-left: 30px; margin-top: 24px; width: 37%; max-width: 37%; margin-bottom: 22px;">
<div class="figure">
<img src="../images/porgs/porg_names_tbl.png" />

</div>
</div>
<div style="clear: both;">

</div>
<p><br></p>
<p><strong>Hey now!</strong> That’s not very helpful. Who’s who? Let’s join their names to the rest of the data.</p>
<div class="figure">
<img src="../images/porgs/leftjoin_porgs.png" style="width: 95%; max-width: 95%;" />

</div>
<p><br></p>
</div>
<div id="whats-the-result" class="section level3 unnumbered">
<h3><strong>What’s the result?</strong></h3>
<div class="well">
<div class="figure">
<img src="../images/porgs/porgs_and_names.png" style="width: 85%; max-width: 85%;" />

</div>
</div>
<p><br></p>
<blockquote>
<p><strong>Let’s try adding MET data to our ozone observations.</strong></p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">met_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/met_data.csv&quot;</span>)

ozone_met &lt;-<span class="st"> </span><span class="kw">left_join</span>(air_data, met_data, 
                       <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;cal_date&quot;</span> =<span class="st"> &quot;date&quot;</span>, 
                              <span class="st">&quot;site&quot;</span>     =<span class="st"> &quot;site&quot;</span>, 
                              <span class="st">&quot;hour&quot;</span>     =<span class="st"> &quot;hour&quot;</span>)) </code></pre></div>
<blockquote>
<p>Now we can take a look at our new columns.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(ozone_met)</code></pre></div>
<pre><code>## Observations: 6,467
## Variables: 14
## $ date_time &lt;dttm&gt; 2015-04-01 06:00:00, 2015-04-01 07:00:00, 2015-04-0...
## $ site      &lt;chr&gt; &quot;27-017-7417&quot;, &quot;27-017-7417&quot;, &quot;27-017-7417&quot;, &quot;27-017...
## $ ozone     &lt;dbl&gt; 37, 37, 36, 36, 36, 28, 34, 38, 35, 34, 34, 36, 36, ...
## $ lat       &lt;dbl&gt; 46.71369, 46.71369, 46.71369, 46.71369, 46.71369, 46...
## $ lon       &lt;dbl&gt; -92.51172, -92.51172, -92.51172, -92.51172, -92.5117...
## $ temp_f    &lt;dbl&gt; 32.60, 32.51, 30.88, 30.78, 30.69, 30.66, 30.76, 44....
## $ units     &lt;chr&gt; &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PP...
## $ year      &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015...
## $ month     &lt;ord&gt; Apr, Apr, Apr, Apr, Apr, Apr, Apr, Apr, Apr, Apr, Ap...
## $ day       &lt;ord&gt; Wed, Wed, Wed, Wed, Wed, Wed, Wed, Wed, Wed, Wed, We...
## $ hour      &lt;dbl&gt; 6, 7, 8, 9, 10, 11, 12, 17, 18, 19, 20, 21, 22, 23, ...
## $ cal_date  &lt;date&gt; 2015-04-01, 2015-04-01, 2015-04-01, 2015-04-01, 201...
## $ ws        &lt;dbl&gt; 10.62, 9.81, 8.96, 8.16, 9.99, 9.24, 9.28, 12.84, 10...
## $ wd        &lt;dbl&gt; 87, 97, 89, 97, 90, 105, 96, 108, 108, 91, 111, 111,...</code></pre>
</div>
<div id="polar-plots" class="section level2">
<h2>Polar plots</h2>
<p>When looking at air concentration data, we often want to know what direction the wind is blowing from when an air pollutant tends to be elevated. This can help to answer if the pollution source is local or if it is more of a regionl issue.</p>
<p>Pairing wind direction and air concentration data helps answer these questions and provide further insights. Polar plots are one way to look at wind data and get to know the wind patterns around your air monitors.</p>
<br><br>
<hr>
<blockquote>
<p>Let’s make sure we’re looking at the data for only one of the sites.</p>
</blockquote>
<div id="filter-to-a-single-site" class="section level3 unnumbered">
<h3>Filter to a single site</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ozone_met &lt;-<span class="st"> </span><span class="kw">filter</span>(ozone_met, site <span class="op">==</span><span class="st"> &quot;27-017-7417&quot;</span>)</code></pre></div>
</div>
<div id="plot-the-wind-directions" class="section level3 unnumbered">
<h3>Plot the wind directions</h3>
<p>For wind directions we’ll use a <em>polar</em> plot to align with the compass directions.</p>
<p><strong>Polar plot</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone_met, <span class="kw">aes</span>(<span class="dt">x =</span> wd, <span class="dt">y =</span> ozone)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">coord_polar</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dt">by =</span> <span class="dv">90</span>), 
                         <span class="dt">lim    =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">360</span>), 
                         <span class="dt">label  =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;E&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;N&quot;</span>)) <span class="op">+</span>
<span class="st">      </span><span class="kw">theme_minimal</span>()</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/polar-1.png" width="672" /></p>
<p><strong>Let’s color the points by <code>ozone</code> concentration</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone_met, <span class="kw">aes</span>(<span class="dt">x =</span> wd, <span class="dt">y =</span> ozone, <span class="dt">color =</span> ozone)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">coord_polar</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dt">by =</span> <span class="dv">90</span>), 
                         <span class="dt">lim    =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">360</span>),
                         <span class="dt">label  =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;E&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;N&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">scale_color_viridis_c</span>()</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/polar-color-1.png" width="672" /></p>
<div class="tip">
<h4 id="exercise-2"><i class="fa fa-bicycle" aria-hidden="true" style="color: darkgreen"></i> EXERCISE</h4>
<p>Let’s experiment with the transparency of the points by changing the <code>alpha =</code> value.</p>
<ul>
<li><p>How does changing the value to <code>alpha = 0.1</code> change the chart?</p></li>
<li><p>How about <code>alpha = 0.9</code>?</p></li>
<li><p>Try increasing and decreasing the <code>size = 2</code> argument.</p></li>
</ul>
</div>
</div>
</div>
<div id="calendar-plot" class="section level2">
<h2>Calendar plot</h2>
<p>Sometimes with air data we want to know if there is seasonality in the data, or if there were dates with very high values. Calendar plots are great for this.</p>
<blockquote>
<p>Let’s make this plot for only the year 2015. To do that we’ll first use <code>filter()</code>.</p>
</blockquote>
<div id="filter-to-a-single-year" class="section level3 unnumbered">
<h3>Filter to a single year</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ozone_met &lt;-<span class="st"> </span><span class="kw">filter</span>(ozone_met, year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>)</code></pre></div>
</div>
<div id="filter-to-a-date-range" class="section level3 unnumbered">
<h3>Filter to a date range</h3>
<p>You can also check whether a date is before or after a certain day in history.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ozone_met &lt;-<span class="st"> </span><span class="kw">filter</span>(ozone_met, cal_date <span class="op">&lt;</span><span class="st"> &quot;2016-01-01&quot;</span>, cal_date <span class="op">&gt;</span><span class="st"> &quot;2014-01-01&quot;</span>)</code></pre></div>
<p><br></p>
<blockquote>
<p>Now we can look at our data by hour for each day of the week.</p>
</blockquote>
<p><br></p>
</div>
<div id="plot-ozone-by-hour-for-each-day-of-the-week" class="section level3 unnumbered">
<h3>Plot ozone by hour for each day of the week</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone_met, <span class="kw">aes</span>(<span class="dt">x =</span> day, <span class="dt">y =</span> hour, <span class="dt">fill =</span> ozone)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) </code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/calendar_day2-1.png" width="672" /></p>
<p><br></p>
<blockquote>
<p>We can also compare concentrations by day of the week for every month.</p>
</blockquote>
<p><br></p>
</div>
<div id="plot-concentration-by-day-of-the-week-for-each-month" class="section level3 unnumbered">
<h3>Plot concentration by day of the week for each month</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone_met, <span class="kw">aes</span>(day, month, <span class="dt">fill =</span> ozone)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>)</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/calendar_month2-1.png" width="672" /></p>
<p><br></p>
<blockquote>
<p>Lastly, let’s compare by day of the week and hour of the day again. But this time, we’ll split it into separate charts for each month.</p>
</blockquote>
</div>
<div id="plot-concentration-by-hour-for-each-day-of-the-week-and-month" class="section level3 unnumbered">
<h3>Plot concentration by hour for each day of the week and month</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone_met, <span class="kw">aes</span>(hour, day, <span class="dt">fill =</span> ozone)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>month)</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/calendar_year-1.png" width="1000" /></p>
<p><br></p>
<div class="tip">
<h4 id="exercise-3"><i class="fa fa-bicycle" aria-hidden="true" style="color: darkgreen"></i> EXERCISE</h4>
<p>What do the blank spaces mean? Is there a pattern?</p>
<p>To take a closer look at the missing values you can use <code>filter()</code> to select only the Sunday ozone concentrations. Let’s look at all the data where the <code>day == &quot;Sun&quot;</code> and the hour is between <code>6</code> and <code>10</code>.</p>
<p>Try completing the code below to get a Sunday table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">miss_data &lt;-<span class="st"> </span><span class="kw">filter</span>(ozone_met,
                          day  <span class="op">==</span><span class="st">  </span>______,
                          hour <span class="op">&gt;</span><span class="st">   </span>______,
                          hour <span class="op">&lt;</span><span class="st">   </span>______ )</code></pre></div>
</div>
</div>
</div>
</div>
<div id="group-and-summarize-the-data" class="section level1">
<h1>6. | Group and Summarize the data</h1>
<p>To calculate a summary statistic for each group in the data we use <code>group_by()</code>.</p>
<blockquote>
<p>First group the data by month and by site.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_data &lt;-<span class="st"> </span><span class="kw">group_by</span>(air_data, site, month)</code></pre></div>
<blockquote>
<p>Next use <code>summarize()</code> to make a table showing the average ozone concentration for each group. Summarize automatically includes a result for each group that we created above.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">air_summary &lt;-<span class="st"> </span><span class="kw">summarize</span>(air_data, <span class="dt">avg_ozone =</span> <span class="kw">mean</span>(ozone))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">site</th>
<th align="left">month</th>
<th align="right">avg_ozone</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">27-017-7417</td>
<td align="left">Jan</td>
<td align="right">21.83333</td>
</tr>
<tr class="even">
<td align="left">27-017-7417</td>
<td align="left">Apr</td>
<td align="right">41.14162</td>
</tr>
<tr class="odd">
<td align="left">27-017-7417</td>
<td align="left">May</td>
<td align="right">35.58921</td>
</tr>
<tr class="even">
<td align="left">27-017-7417</td>
<td align="left">Jun</td>
<td align="right">29.67382</td>
</tr>
<tr class="odd">
<td align="left">27-017-7417</td>
<td align="left">Jul</td>
<td align="right">28.77980</td>
</tr>
<tr class="even">
<td align="left">27-017-7417</td>
<td align="left">Aug</td>
<td align="right">22.38042</td>
</tr>
<tr class="odd">
<td align="left">27-017-7417</td>
<td align="left">Sep</td>
<td align="right">24.92604</td>
</tr>
<tr class="even">
<td align="left">27-017-7417</td>
<td align="left">Oct</td>
<td align="right">22.46959</td>
</tr>
<tr class="odd">
<td align="left">27-017-7417</td>
<td align="left">Nov</td>
<td align="right">20.95319</td>
</tr>
<tr class="even">
<td align="left">27-017-7417</td>
<td align="left">Dec</td>
<td align="right">19.32316</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="tip">
<h4 id="exercise-4"><i class="fa fa-bicycle" aria-hidden="true" style="color: darkgreen"></i> EXERCISE</h4>
<p>Let’s plot our summary table for Rey. If we want column showing the average concentration for each month, we can use <code>geom_col()</code>.</p>
<p>Here’s a template to get started. Fill in <code>x =</code> and <code>y =</code> to complete the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_summary, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">----</span><span class="st"> </span>, <span class="dt">y =</span> <span class="op">---</span><span class="st"> </span>, <span class="dt">fill =</span> avg_ozone)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
</div>
<div id="add-labels" class="section level2 unnumbered">
<h2>Add labels</h2>
<p>We can add lables to the chart by adding the <code>labs()</code> layer. Let’s give our chart from above a title.</p>
<p><strong>Titles and labels</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_summary, <span class="kw">aes</span>(<span class="dt">x =</span> month , <span class="dt">y =</span> avg_ozone, <span class="dt">fill =</span> avg_ozone)) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">     </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;2015 Ozone by Month&quot;</span>, 
          <span class="dt">subtitle =</span> <span class="st">&quot;Concentration in PPB&quot;</span>,
          <span class="dt">y =</span> <span class="st">&quot;OZONE&quot;</span>)</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p><br></p>
<blockquote>
<p>More layers! Rey’s been advised to avoid concentrations over <em>22 ppb</em>. Let’s add that as a horizontal line to our chart. For that, we use <code>geom_hline()</code>.</p>
</blockquote>
</div>
<div id="add-lines" class="section level2 unnumbered">
<h2>Add lines</h2>
<p><strong>Reference lines</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(air_summary, <span class="kw">aes</span>(<span class="dt">x =</span> month , <span class="dt">y =</span> avg_ozone, <span class="dt">fill =</span> avg_ozone)) <span class="op">+</span><span class="st"> </span>
<span class="st">     </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">     </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;2015 Ozone by Month&quot;</span>, 
          <span class="dt">subtitle =</span> <span class="st">&quot;Concentration in PPB&quot;</span>,
          <span class="dt">y =</span> <span class="st">&quot;OZONE&quot;</span>) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">22</span>, <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="/post/NTF2019_post_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="save-results" class="section level1">
<h1>7. | Save results</h1>
<blockquote>
<p>Save the summarized data table</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(air_summary, <span class="st">&quot;2015-2017_ozone_summary.csv&quot;</span>)</code></pre></div>
<p><details> <summary class = "btn_code"> <strong>Bonus</strong> Save to AQS format </summary></p>
<div class="quiz" style="margin-top: -9px;">
<p>
<p>AQS format is similar to a CSV, but instead of a <code>,</code> it uses the <code>|</code> to separate values. Oh, and we also need to have <strong>28 columns</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load packages</span>
<span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(janitor)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(stringr)

<span class="co"># Columns names in AQS</span>
aqs_columns &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Transaction Type&quot;</span>, <span class="st">&quot;Action Indicator&quot;</span>, <span class="st">&quot;State Code&quot;</span>,
                  <span class="st">&quot;County Code&quot;</span>, <span class="st">&quot;Site Number&quot;</span>, <span class="st">&quot;Parameter&quot;</span>,
                  <span class="st">&quot;POC&quot;</span>, <span class="st">&quot;Duration Code&quot;</span>, <span class="st">&quot;Reported Unit&quot;</span>,
                  <span class="st">&quot;Method Code&quot;</span>, <span class="st">&quot;Sample Date&quot;</span>, <span class="st">&quot;Sample Begin Time&quot;</span>,
                  <span class="st">&quot;Reported Sample Value&quot;</span>, <span class="st">&quot;Null Data Code&quot;</span>, <span class="st">&quot;Collection Frequency Code&quot;</span>,
                  <span class="st">&quot;Monitor Protocol ID&quot;</span>, <span class="st">&quot;Qualifier Code - 1&quot;</span>, <span class="st">&quot;Qualifier Code - 2&quot;</span>,
                  <span class="st">&quot;Qualifier Code - 3&quot;</span>, <span class="st">&quot;Qualifier Code - 4&quot;</span>, <span class="st">&quot;Qualifier Code - 5&quot;</span>,
                  <span class="st">&quot;Qualifier Code - 6&quot;</span>, <span class="st">&quot;Qualifier Code - 7&quot;</span>, <span class="st">&quot;Qualifier Code - 8&quot;</span>,
                  <span class="st">&quot;Qualifier Code - 9&quot;</span>, <span class="st">&quot;Qualifier Code - 10&quot;</span>, <span class="st">&quot;Alternate Method Detection Limit&quot;</span>,
                  <span class="st">&quot;Uncertainty Value&quot;</span>)

<span class="co"># Read in our data</span>
my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/ozone_samples.csv&quot;</span>)

<span class="co"># Clean the names</span>
my_data &lt;-<span class="st"> </span><span class="kw">clean_names</span>(my_data)

<span class="co"># View the column names</span>
<span class="kw">names</span>(my_data)</code></pre></div>
<pre><code>## [1] &quot;date_time&quot; &quot;site&quot;      &quot;ozone&quot;     &quot;latitude&quot;  &quot;longitude&quot; &quot;temp_f&quot;   
## [7] &quot;units&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Format the date column</span>
<span class="co"># Date is in year-month-day format, use &quot;ymd_hms()&quot;</span>
my_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(my_data, <span class="dt">date_time =</span> <span class="kw">ymd_hms</span>(date_time),
                           <span class="dt">cal_date  =</span> <span class="kw">date</span>(date_time))

<span class="co"># Remove dashes from the date, EPA hates dashes</span>
my_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(my_data, <span class="dt">cal_date =</span> <span class="kw">str_replace_all</span>(cal_date, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;&quot;</span>))

<span class="co"># Add hour column</span>
my_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(my_data, <span class="dt">hour =</span> <span class="kw">hour</span>(date_time),
                           <span class="dt">time =</span> <span class="kw">paste</span>(hour, <span class="st">&quot;:00&quot;</span>))

<span class="co"># Create additional columns</span>
my_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(my_data,
                   <span class="dt">state     =</span> <span class="kw">substr</span>(site, <span class="dv">1</span>, <span class="dv">2</span>),
                   <span class="dt">county    =</span> <span class="kw">substr</span>(site, <span class="dv">4</span>, <span class="dv">6</span>),
                   <span class="dt">site_num  =</span> <span class="kw">substr</span>(site, <span class="dv">8</span>, <span class="dv">11</span>),
                   <span class="dt">parameter =</span> <span class="st">&quot;44201&quot;</span>,
                   <span class="dt">poc       =</span> <span class="dv">1</span>,
                   <span class="dt">units     =</span> <span class="st">&quot;007&quot;</span>,
                   <span class="dt">method    =</span> <span class="st">&quot;003&quot;</span>,
                   <span class="dt">duration  =</span> <span class="st">&quot;1&quot;</span>,
                   <span class="dt">null_data_code =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">collection_frequency =</span> <span class="st">&quot;S&quot;</span>,
                   <span class="dt">monitor =</span> <span class="st">&quot;TRIBAL&quot;</span>,
                   <span class="dt">qual_1 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_2 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_3 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_4 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_5 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_6 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_7 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_8 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_9 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">qual_10 =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">alt_meth_det =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">uncertain =</span> <span class="st">&quot;&quot;</span>,
                   <span class="dt">transaction =</span> <span class="st">&quot;RD&quot;</span>,
                   <span class="dt">action =</span> <span class="st">&quot;I&quot;</span>)

<span class="co"># Put the columns in AQS order</span>
my_data &lt;-<span class="st"> </span><span class="kw">select</span>(my_data,
                   transaction, action, state, county,
                   site_num, parameter, poc, duration,
                   units, method, cal_date, time, ozone,
                   null_data_code, collection_frequency,
                   monitor, qual_<span class="dv">1</span>, qual_<span class="dv">2</span>, qual_<span class="dv">3</span>, qual_<span class="dv">4</span>,
                   qual_<span class="dv">5</span>, qual_<span class="dv">6</span>, qual_<span class="dv">7</span>, qual_<span class="dv">8</span>, qual_<span class="dv">9</span>,
                   qual_<span class="dv">10</span>, alt_meth_det, uncertain)

<span class="co"># Set the names to AQS</span>
<span class="kw">names</span>(my_data) &lt;-<span class="st"> </span>aqs_columns

<span class="co"># Save to a &quot;|&quot; separated file</span>
<span class="kw">write_delim</span>(my_data, <span class="st">&quot;2015_AQS_formatted_ozone.txt&quot;</span>,
            <span class="dt">delim        =</span> <span class="st">&quot;|&quot;</span>,
            <span class="dt">quote_escape =</span> <span class="ot">FALSE</span>)

<span class="co"># Read file back in</span>
aqs &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;2015_AQS_formatted_ozone.txt&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;|&quot;</span>)</code></pre></div>
</p>
</div>
<p></details></p>
<p><br></p>
<blockquote>
<p>Save plots</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;Ozone_by_month.png&quot;</span>)</code></pre></div>
</div>
<div id="share-with-friends" class="section level1">
<h1>8. | Share with friends</h1>
<p>Having an exact record of what you did can be great documentation for yourself and others. It’s also handy for when you want to repeat the same analysis on new data. Then all you need to do is copy the script, update the one read data line, and push run to get your new set of fancy charts.</p>
<div id="share-on-github" class="section level2">
<h2>Share on GitHub</h2>
<p><a href = "https://github.com/dKvale/ex__OZONE__Project"> <img src="../images/github_example_ozone.png" style="width: 95%;" /> </a></p>
</div>
<div id="congratulations" class="section level2">
<h2>Congratulations!</h2>
<p>You’ve added some great tools to your data analysis tool belt. Now go forth and put them to use.</p>
<div id="more-data-awaits-you" class="section level3">
<h3>More data awaits you…</h3>
<div class="figure">
<img src="../images/rey_bb8_sand_dunes.gif" style="width: 70%; margin-left: 10%;" />

</div>
</div>
</div>
</div>
<div id="help" class="section level1">
<h1><i class="far fa-question-circle" aria-hidden="true"></i> Help!</h1>
<p>Lost in an ERROR message? Is something behaving strangely and want to know why?</p>
<p>See the <a href="../page/help.html">Help!</a> page for some troubleshooting options.</p>
<p><br></p>
<details style="margin-top: 34px;"> <summary class="btn_code">
<h4 style="font-size: 20px;">
<i class="fas fa-key fa-xs" style="color: #c81888;" aria-hidden="true"></i> Key terms
</h4>
</summary>
<p>
<table>
<colgroup>
<col width="6%" />
<col width="93%" />
</colgroup>
<tbody>
<tr class="odd">
<td><code>package</code></td>
<td align="left">An add-on for R that contains new functions that someone created to help you. It’s like an App for R.</td>
</tr>
<tr class="even">
<td><code>library</code></td>
<td align="left">The name of the folder that stores all your packages, and the function used to load a package.</td>
</tr>
<tr class="odd">
<td><code>function</code></td>
<td align="left">Functions perform an operation on your data and returns a result. The function <code>sum()</code> takes a series of values and returns the sum for you.</td>
</tr>
<tr class="even">
<td><code>argument</code></td>
<td align="left">Arguments are options or inputs that you pass to a function to change how it behaves. The argument <code>skip = 1</code> tells the <code>read_csv()</code> function to ignore the first row when reading in a data file. To see the default values for a function you can type <code>?read_csv</code> in the console.</td>
</tr>
</tbody>
</table>
<br>
</p>
<p></details></p>
</div>
<div id="customize-r-studio" class="section level1">
<h1>Customize R Studio</h1>
<div id="make-it-your-own" class="section level4">
<h4>Make it your own</h4>
<p>Let’s add a little style so R Studio feels like home since you will spend lots of time here. Follow these steps to change the font-size and and color scheme:</p>
<ol style="list-style-type: decimal">
<li>Go to <strong>Tools</strong> on the top navigation bar.</li>
<li>Choose <code>Global Options...</code></li>
<li>Choose <code>Appearance</code> with the paint bucket.</li>
<li>Find something you like.</li>
</ol>
<p><img src="../images/font_change.png" style="width: 53%; margin-top: 18px;"></p>
<p><br></p>
</div>
<div id="return-to-home" class="section level2 unnumbered">
<h2><i class="fa fa-rocket" aria-hidden="true"></i> Return to <a href="../../index.html">Home</a></h2>
</div>
</div>
